<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>S0LACE â€¢ Media</title>
  <link rel="stylesheet" href="index.css" />
  <script src="global-hub.js" defer></script>
</head>
<body>

<nav class="side-header">
  <a href="index.html" class="side-icon" data-icon="home"><img src="thumbs/home/white.png"/></a>
  <a href="games.html" class="side-icon" data-icon="games"><img src="thumbs/games/white.png"/></a>
  <a href="media.html" class="side-icon active" data-icon="media"><img src="thumbs/media/white.png"/></a>
  <a href="settings.html" class="side-icon" data-icon="settings"><img src="thumbs/settings/white.png"/></a>
</nav>

<main>
  <div class="page-header">
    <h1>MEDIA HUB</h1>
    <div class="sub">STREAMING VIA <span id="current-source-display">VIDFAST</span></div>
  </div>

  <div class="games-search-wrap">
    <input id="media-search" type="text" placeholder="SEARCH MOVIES & TV..." />
  </div>

  <div class="media-row">
    <div class="media-row-title">POPULAR MOVIES</div>
    <div class="media-row-track" id="movies-grid"></div>
  </div>

  <div class="media-row">
    <div class="media-row-title">TV SHOWS</div>
    <div class="media-row-track" id="tv-grid"></div>
  </div>
</main>

<script>
  const TMDB_KEY = "2d1351cf74f73892042699d0431b799a";
  const source = localStorage.getItem("s0laceMediaSource") || "vidfast";
  document.getElementById("current-source-display").textContent = source.toUpperCase();

  async function fetchMedia(type, containerId) {
    const res = await fetch(`https://api.themoviedb.org/3/${type}/popular?api_key=${TMDB_KEY}`);
    const data = await res.json();
    const grid = document.getElementById(containerId);
    
    data.results.forEach(item => {
      const card = document.createElement("div");
      card.className = "game-card"; // Using your high-quality rounded class
      card.innerHTML = `
        <div class="game-thumb">
          <img src="https://image.tmdb.org/t/p/w500${item.poster_path}" loading="lazy">
          <div class="game-overlay">${(item.title || item.name).toUpperCase()}</div>
        </div>
      `;
      card.onclick = () => {
        if (type === 'movie') {
          const baseUrl = source === "vidfast" ? `https://vidfast.pro/movie/${item.id}` : `https://cinemaos.tech/player/${item.id}`;
          window.location.href = `mediaplayer.html?src=${encodeURIComponent("/scramjet/" + baseUrl)}&title=${encodeURIComponent(item.title)}`;
        } else {
          window.location.href = `tvplayer.html?id=${item.id}&title=${encodeURIComponent(item.name)}`;
        }
      };
      grid.appendChild(card);
    });
  }

  fetchMedia('movie', 'movies-grid');
  fetchMedia('tv', 'tv-grid');
</script>
</body>
</html>
